<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Packaging Data Infrastructure Audit | Trustori</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Hanken Grotesk as specified in Brand Guide -->
    <link href="https://fonts.googleapis.com/css2?family=Hanken+Grotesk:ital,wght@0,300;0,400;0,500;0,600;0,700;0,800;1,400&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Hanken Grotesk', 'sans-serif'],
                    },
                    colors: {
                        trustori: {
                            blue: '#0047BA',     /* Pantone 2728 C */
                            dark: '#24272A',     /* Pantone 426 C */
                            orange: '#FF671D',   /* Pantone 165 C */
                            lightblue: '#2A7DE1' /* Pantone 2727 C */
                        }
                    },
                    backgroundImage: {
                        'brand-mesh': 'linear-gradient(135deg, #0047BA 0%, #002e7a 50%, #24272A 100%)',
                        'brand-accent': 'linear-gradient(90deg, #0047BA 0%, #2A7DE1 50%, #FF671D 100%)'
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.6s ease-out forwards',
                        'slide-up': 'slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'slide-left': 'slideLeft 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                        'slide-right': 'slideRight 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(30px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        slideLeft: {
                            '0%': { opacity: '0', transform: 'translateX(20px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' },
                        },
                        slideRight: {
                            '0%': { opacity: '0', transform: 'translateX(-20px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' },
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Hanken Grotesk', sans-serif; background-color: #F8F9FA; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #F1F5F9; }
        ::-webkit-scrollbar-thumb { background: #CBD5E1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94A3B8; }

        /* Smooth Scroll */
        html { scroll-behavior: smooth; }

        /* Form Inputs */
        .trustori-input {
            width: 100%;
            background-color: #F8F9FA;
            border: 2px solid #E2E8F0;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            color: #24272A;
            font-weight: 500;
            transition: all 0.2s;
            outline: none;
        }
        .trustori-input:focus {
            border-color: #0047BA;
            background-color: #FFFFFF;
            box-shadow: 0 0 0 4px rgba(0, 71, 186, 0.1);
        }

        /* Likert 3-Option Styles */
        .likert-btn {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .likert-btn:hover {
            transform: scale(1.05);
            background-color: rgba(0,0,0,0.02);
        }
        .likert-btn.selected {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        /* Question Hover Effect */
        .question-trigger {
            cursor: pointer;
            transition: color 0.2s;
        }
        .question-trigger:hover {
            color: #2A7DE1;
        }
        .question-trigger i {
            font-size: 0.8em;
            margin-left: 0.5rem;
            color: #CBD5E1;
            transition: color 0.2s;
        }
        .question-trigger:hover i {
            color: #0047BA;
        }

        @media print {
            .no-print { display: none !important; }
            body { background: white; color: black; }
            #results-section { display: block !important; }
            #survey-container { display: none !important; }
            .bg-trustori-blue { background-color: white !important; color: black !important; }
            .text-white { color: black !important; }
        }
    </style>
</head>
<body class="text-trustori-dark antialiased min-h-screen flex flex-col overflow-x-hidden">

    <!-- Navbar -->
    <nav class="absolute top-0 z-50 w-full border-b border-white/10">
        <div class="container max-w-7xl mx-auto h-16 md:h-20 flex items-center justify-between px-4 md:px-8">
            <div class="flex items-center gap-3">
                <div class="relative w-7 h-7 md:w-8 md:h-8 flex items-center justify-center">
                    <i class="fa-solid fa-asterisk text-white text-xl md:text-2xl"></i> 
                </div>
                <div class="flex flex-col">
                    <span class="font-bold text-xl md:text-2xl text-white tracking-tight leading-none">trustori</span>
                    <span class="text-[8px] md:text-[9px] text-white/80 uppercase tracking-[0.2em] font-medium mt-0.5">The Brand Custodian</span>
                </div>
            </div>
            <div class="flex items-center gap-6 no-print">
                <button onclick="window.print()" class="text-white/80 hover:text-white transition-colors flex items-center gap-2 text-xs md:text-sm font-medium hidden md:flex">
                    <i class="fa-solid fa-print"></i> <span>Save Report</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="bg-brand-mesh relative pt-28 pb-24 md:pt-40 md:pb-32 px-4 md:px-8 overflow-hidden">
        <div class="absolute top-0 right-0 w-[400px] h-[400px] md:w-[800px] md:h-[800px] bg-trustori-orange/20 rounded-full blur-[80px] md:blur-[120px] -translate-y-1/2 translate-x-1/2 md:translate-x-1/3 pointer-events-none mix-blend-screen"></div>
        <div class="absolute bottom-0 left-0 w-[300px] h-[300px] md:w-[600px] md:h-[600px] bg-trustori-lightblue/20 rounded-full blur-[60px] md:blur-[100px] translate-y-1/3 -translate-x-1/4 pointer-events-none mix-blend-screen"></div>

        <div class="container max-w-7xl mx-auto relative z-10">
            <div class="max-w-4xl animate-slide-up">
                <div class="inline-flex items-center gap-2 px-3 py-1 bg-white/10 backdrop-blur-sm border border-white/20 rounded-full mb-4 md:mb-6">
                    <span class="w-1.5 h-1.5 md:w-2 md:h-2 rounded-full bg-trustori-orange"></span>
                    <span class="text-white text-[10px] md:text-xs font-bold uppercase tracking-widest">Diagnostic Audit</span>
                </div>
                <h1 class="text-3xl sm:text-4xl md:text-7xl font-bold text-white leading-[1.1] mb-4 md:mb-6 tracking-tight">
                    Packaging Infrastructure <br class="hidden sm:block">
                    <span class="text-transparent bg-clip-text bg-gradient-to-r from-white to-white/70 block sm:inline">Audit Assessment</span>
                </h1>
                <p id="page-subtitle" class="text-base md:text-xl text-white/80 font-normal leading-relaxed max-w-2xl">
                    Evaluate your brand's data maturity. Identify operational blind spots and map them to strategic capabilities.
                </p>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 container max-w-4xl mx-auto -mt-12 md:-mt-20 relative z-20 px-4 md:px-0 mb-16 md:mb-24">

        <!-- Survey Card (Stepper) -->
        <div id="survey-container" class="bg-white rounded-lg shadow-xl shadow-trustori-dark/5 p-6 md:p-12 animate-slide-up" style="animation-delay: 0.1s;">
            
            <!-- Stepper Header -->
            <div class="mb-10">
                <div class="flex items-center justify-between mb-4">
                    <h3 class="text-xl md:text-2xl font-bold text-trustori-blue" id="step-main-title">Company Profile</h3>
                    <span class="text-sm font-bold text-trustori-orange" id="step-counter">Step 1 of 4</span>
                </div>
                <!-- Progress Bar -->
                <div class="w-full bg-gray-100 rounded-full h-2 overflow-hidden">
                    <div id="progress-bar" class="bg-trustori-blue h-2 rounded-full transition-all duration-500 ease-out" style="width: 25%"></div>
                </div>
            </div>
            
            <!-- ================= STEP 1: BIOGRAPHIC DATA ================= -->
            <div id="step-1" class="step-content animate-slide-in">
                <div class="flex items-center gap-3 mb-8 pb-4 border-b border-gray-100">
                    <div class="w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center text-trustori-dark shrink-0">
                        <i class="fa-solid fa-address-card"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold text-trustori-dark">Contact Information</h4>
                        <p class="text-sm text-gray-500">Please provide your details to customize your report.</p>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="col-span-1 md:col-span-2">
                        <label class="block text-sm font-bold text-trustori-dark mb-2">Company / Brand Name *</label>
                        <input type="text" id="contact-company" class="trustori-input" placeholder="e.g. Acme Corp" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-trustori-dark mb-2">Full Name *</label>
                        <input type="text" id="contact-name" class="trustori-input" placeholder="John Doe" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-trustori-dark mb-2">Job Title</label>
                        <input type="text" id="contact-title" class="trustori-input" placeholder="e.g. Supply Chain Director">
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-trustori-dark mb-2">Work Email *</label>
                        <input type="email" id="contact-email" class="trustori-input" placeholder="john@company.com" required>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-trustori-dark mb-2">Phone Number</label>
                        <input type="tel" id="contact-phone" class="trustori-input" placeholder="+1 (555) 000-0000">
                    </div>
                </div>
                <!-- Validation Error Msg -->
                <p id="step-1-error" class="text-red-500 text-sm font-bold mt-4 hidden"><i class="fa-solid fa-circle-exclamation mr-1"></i> Please fill in all required fields.</p>
            </div>

            <!-- ================= STEP 2: STRATEGIC ALIGNMENT ================= -->
            <div id="step-2" class="step-content hidden">
                <div class="flex items-center gap-3 mb-8 pb-4 border-b border-gray-100">
                    <div class="w-10 h-10 rounded-full bg-orange-50 flex items-center justify-center text-trustori-orange shrink-0">
                        <i class="fa-solid fa-lightbulb"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold text-trustori-dark">Strategic Alignment</h4>
                        <p class="text-sm text-gray-500">How does leadership view the importance of data and packaging?</p>
                    </div>
                </div>

                <div class="space-y-12">
                    <!-- A1 -->
                    <div class="group">
                        <div class="flex justify-between items-center mb-3">
                            <label onclick="openModal('a1')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-orange transition-colors pr-4 question-trigger">
                                1. How critical is direct 1st-party consumer data to your brand's future growth? <i class="fa-solid fa-circle-info"></i>
                            </label>
                        </div>
                        <input type="hidden" id="input-a1" value="2">
                        <div id="scale-a1" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <div class="flex flex-col gap-1 mt-3">
                            <p id="desc-a1" class="text-xs font-semibold text-gray-500 transition-all duration-300">Select an option above</p>
                        </div>
                    </div>

                    <!-- A2 -->
                    <div class="group">
                        <div class="flex justify-between items-center mb-3">
                            <label onclick="openModal('a2')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-orange transition-colors pr-4 question-trigger">
                                2. Is packaging viewed by leadership as a digital asset or just a physical cost? <i class="fa-solid fa-circle-info"></i>
                            </label>
                        </div>
                        <input type="hidden" id="input-a2" value="2">
                        <div id="scale-a2" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <div class="flex flex-col gap-1 mt-3">
                            <p id="desc-a2" class="text-xs font-semibold text-gray-500 transition-all duration-300">Select an option above</p>
                        </div>
                    </div>

                    <!-- A3 -->
                    <div class="group">
                        <div class="flex justify-between items-center mb-3">
                            <label onclick="openModal('a3')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-orange transition-colors pr-4 question-trigger">
                                3. How urgently do you need to address grey market diversion or counterfeiting? <i class="fa-solid fa-circle-info"></i>
                            </label>
                        </div>
                        <input type="hidden" id="input-a3" value="2">
                        <div id="scale-a3" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <div class="flex flex-col gap-1 mt-3">
                            <p id="desc-a3" class="text-xs font-semibold text-gray-500 transition-all duration-300">Select an option above</p>
                        </div>
                    </div>

                    <!-- A4 -->
                    <div class="group">
                        <div class="flex justify-between items-center mb-3">
                            <label onclick="openModal('a4')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-orange transition-colors pr-4 question-trigger">
                                4. Is automated ESG (Environmental) and Compliance tracking a strategic priority? <i class="fa-solid fa-circle-info"></i>
                            </label>
                        </div>
                        <input type="hidden" id="input-a4" value="2">
                        <div id="scale-a4" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <div class="flex flex-col gap-1 mt-3">
                            <p id="desc-a4" class="text-xs font-semibold text-gray-500 transition-all duration-300">Select an option above</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ================= STEP 3: OPERATIONAL GAPS ================= -->
            <div id="step-3" class="step-content hidden">
                <div class="flex items-center gap-3 mb-8 pb-4 border-b border-gray-100">
                    <div class="w-10 h-10 rounded-full bg-red-50 flex items-center justify-center text-red-500 shrink-0">
                        <i class="fa-solid fa-triangle-exclamation"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold text-trustori-dark">Identify Operational Gaps</h4>
                        <p class="text-sm text-gray-500">Rate your current risk exposure (1 = High Risk, 10 = Low Risk/Optimized).</p>
                    </div>
                </div>

                <div class="space-y-12">
                    <!-- P1 - P8 Logic unchanged, truncated for readability in skeleton view but kept in full code -->
                    <!-- Loop generation applied for brevity in source, explicitly writing out -->
                    <!-- P1 -->
                    <div class="group"><label onclick="openModal('p1')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">1. Do you know who buys your product? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p1" value="2"><div id="scale-p1" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p1" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P2 -->
                    <div class="group"><label onclick="openModal('p2')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">2. Can you instantly spot diverted stock? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p2" value="2"><div id="scale-p2" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p2" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P3 -->
                    <div class="group"><label onclick="openModal('p3')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">3. Is your security easy to replicate? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p3" value="2"><div id="scale-p3" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p3" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P4 -->
                    <div class="group"><label onclick="openModal('p4')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">4. Can you recall specific bad units? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p4" value="2"><div id="scale-p4" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p4" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P5 -->
                    <div class="group"><label onclick="openModal('p5')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">5. Is your packaging a sunk cost? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p5" value="2"><div id="scale-p5" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p5" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P6 -->
                    <div class="group"><label onclick="openModal('p6')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">6. Are audits manual and painful? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p6" value="2"><div id="scale-p6" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p6" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P7 -->
                    <div class="group"><label onclick="openModal('p7')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">7. Is your green impact measurable? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p7" value="2"><div id="scale-p7" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p7" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- P8 -->
                    <div class="group"><label onclick="openModal('p8')" class="text-base font-bold text-trustori-dark group-hover:text-red-600 transition-colors pr-4 question-trigger">8. Can you reroute stock instantly? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-p8" value="2"><div id="scale-p8" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-p8" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                </div>
            </div>

            <!-- ================= STEP 4: SYSTEM CAPABILITIES ================= -->
            <div id="step-4" class="step-content hidden">
                <div class="flex items-center gap-3 mb-8 pb-4 border-b border-gray-100">
                    <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-trustori-blue shrink-0">
                        <i class="fa-solid fa-bullseye"></i>
                    </div>
                    <div>
                        <h4 class="text-lg font-bold text-trustori-dark">Assess System Capabilities</h4>
                        <p class="text-sm text-gray-500">Rate your current infrastructure readiness.</p>
                    </div>
                </div>

                <div class="space-y-12">
                    <!-- S1 to S8 -->
                    <!-- S1 -->
                    <div class="group"><label onclick="openModal('s1')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">1. Do you capture direct consumer emails? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s1" value="2"><div id="scale-s1" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s1" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S2 -->
                    <div class="group"><label onclick="openModal('s2')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">2. How granular is your location tracking? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s2" value="2"><div id="scale-s2" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s2" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S3 -->
                    <div class="group"><label onclick="openModal('s3')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">3. How strong is your authentication? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s3" value="2"><div id="scale-s3" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s3" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S4 -->
                    <div class="group"><label onclick="openModal('s4')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">4. Is each unit uniquely identified? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s4" value="2"><div id="scale-s4" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s4" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S5 -->
                    <div class="group"><label onclick="openModal('s5')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">5. Does your engagement drive loyalty? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s5" value="2"><div id="scale-s5" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s5" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S6 -->
                    <div class="group"><label onclick="openModal('s6')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">6. Is your compliance automated? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s6" value="2"><div id="scale-s6" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s6" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S7 -->
                    <div class="group"><label onclick="openModal('s7')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">7. Do you have material lifecycle data? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s7" value="2"><div id="scale-s7" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s7" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                    <!-- S8 -->
                    <div class="group"><label onclick="openModal('s8')" class="text-base font-bold text-trustori-dark group-hover:text-trustori-blue transition-colors pr-4 question-trigger">8. Are you making real-time decisions? <i class="fa-solid fa-circle-info"></i></label>
                        <input type="hidden" id="input-s8" value="2"><div id="scale-s8" class="flex justify-start gap-8 mt-2 select-none"></div>
                        <p id="desc-s8" class="text-xs font-semibold text-gray-500 mt-3 transition-all duration-300">Select an option above</p>
                    </div>
                </div>
            </div>

            <!-- Stepper Navigation -->
            <div class="mt-12 md:mt-16 flex justify-between items-center border-t border-gray-100 pt-8">
                <button id="btn-back" onclick="navigateStep(-1)" class="text-gray-400 hover:text-trustori-dark font-bold text-sm transition-colors flex items-center gap-2 hidden">
                    <i class="fa-solid fa-arrow-left"></i> Back
                </button>
                
                <div class="flex-1"></div> <!-- Spacer -->

                <button id="btn-next" onclick="navigateStep(1)" class="w-full sm:w-auto bg-trustori-blue hover:bg-blue-800 text-white font-bold py-3.5 px-10 rounded shadow-lg shadow-blue-900/20 transition-all duration-300 flex items-center justify-center gap-3 group text-sm md:text-base">
                    Next Step
                    <i class="fa-solid fa-arrow-right text-trustori-orange group-hover:translate-x-1 transition-transform"></i>
                </button>

                <button id="btn-submit" onclick="calculateAndShowResults()" class="hidden w-full sm:w-auto bg-trustori-orange hover:bg-orange-600 text-white font-bold py-3.5 px-10 rounded shadow-lg shadow-orange-600/20 transition-all duration-300 flex items-center justify-center gap-3 group text-sm md:text-base relative overflow-hidden">
                    <span id="submit-text">Generate Analysis</span>
                    <i id="submit-icon" class="fa-solid fa-chart-pie group-hover:rotate-12 transition-transform ml-2"></i>
                    <i id="submit-spinner" class="fa-solid fa-spinner fa-spin hidden ml-2"></i>
                </button>
            </div>
        </div>

        <!-- RESULTS SECTION -->
        <div id="results-section" class="hidden animate-fade-in space-y-6 md:space-y-8">
            
            <div class="bg-white rounded-lg shadow-xl shadow-trustori-dark/5 overflow-hidden border border-gray-100">
                <div class="grid grid-cols-1 lg:grid-cols-12 min-h-[500px]">
                    
                    <!-- Left: Radar Chart -->
                    <div class="lg:col-span-8 p-6 md:p-12 relative flex flex-col justify-center order-2 lg:order-1">
                        <div class="flex justify-between items-start mb-6">
                            <div>
                                <h3 class="text-xl md:text-2xl font-bold text-trustori-dark">Performance Matrix</h3>
                                <p class="text-xs md:text-sm text-gray-500 mt-1">Aggregated maturity against Industry Gold Standard.</p>
                            </div>
                            <div class="flex gap-4 md:gap-6 text-[9px] md:text-[10px] font-bold uppercase tracking-widest">
                                <div class="flex items-center gap-2">
                                    <span class="block w-2.5 h-1 md:w-3 bg-trustori-orange"></span> YOU
                                </div>
                                <div class="flex items-center gap-2">
                                    <span class="block w-2.5 h-1 md:w-3 bg-trustori-blue"></span> GOAL
                                </div>
                            </div>
                        </div>
                        <div class="relative w-full h-[350px] md:h-[450px] flex items-center justify-center">
                            <canvas id="auditRadarChart"></canvas>
                        </div>
                    </div>

                    <!-- Right: Score Panel -->
                    <div class="lg:col-span-4 bg-trustori-blue p-8 md:p-12 flex flex-col justify-center relative text-white order-1 lg:order-2">
                        <div class="absolute top-0 right-0 p-8 opacity-10 pointer-events-none">
                            <i class="fa-solid fa-asterisk text-8xl md:text-9xl"></i>
                        </div>
                        
                        <div class="relative z-10">
                            <span class="text-trustori-orange text-[10px] md:text-xs font-bold uppercase tracking-[0.2em] block mb-2 md:mb-4">Maturity Index</span>
                            <div class="text-5xl md:text-6xl font-bold text-white mb-2" id="score-total">Low</div>
                            <div class="w-12 h-1.5 bg-trustori-orange mb-6 md:mb-8"></div>
                            
                            <p class="text-white/80 font-normal leading-relaxed mb-8 md:mb-12 text-sm" id="score-description">
                                Analysis pending...
                            </p>
                            
                            <button onclick="resetAnalysis()" class="w-full bg-white/10 hover:bg-white/20 border border-white/30 text-white font-bold py-3.5 px-6 rounded transition-all duration-300 flex items-center justify-center gap-3 text-xs md:text-sm tracking-wide">
                                <i class="fa-solid fa-rotate-left"></i>
                                RETRY ASSESSMENT
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommendations Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6" id="recommendations-container">
                <!-- Injected via JS -->
            </div>

            <!-- CTA Section -->
            <div class="mt-12 pt-10 border-t border-gray-200 text-center">
                <h3 class="text-2xl font-bold text-trustori-dark mb-4">Ready to close these gaps?</h3>
                <p class="text-gray-500 mb-8 max-w-2xl mx-auto">Transform your packaging from a cost center into a strategic asset. Connect with our experts today.</p>
                <div class="flex flex-col sm:flex-row justify-center gap-4">
                    <button class="bg-trustori-orange hover:bg-orange-600 text-white font-bold py-4 px-8 rounded shadow-lg transition-all flex items-center justify-center gap-3">
                        <i class="fa-solid fa-calendar-check"></i>
                        Book Consultation
                    </button>
                    <button class="bg-green-600 hover:bg-green-700 text-white font-bold py-4 px-8 rounded shadow-lg transition-all flex items-center justify-center gap-3">
                        <i class="fa-brands fa-whatsapp text-xl"></i>
                        WhatsApp to Know More
                    </button>
                </div>
            </div>

        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-auto no-print">
        <div class="container max-w-7xl mx-auto px-6 py-8 md:py-10 flex flex-col md:flex-row justify-between items-center gap-4 md:gap-6">
            <div class="flex items-center gap-3">
                <i class="fa-solid fa-asterisk text-trustori-blue text-xl"></i>
                <div class="flex flex-col">
                    <span class="font-bold text-lg text-trustori-dark leading-none">trustori</span>
                </div>
            </div>
            <p class="text-[10px] md:text-xs text-gray-400 text-center md:text-right">
                &copy; 2025 Trustori. Protecting Originality. Empowering Growth.
            </p>
        </div>
    </footer>

    <!-- INFO MODAL -->
    <div id="info-modal" class="fixed inset-0 z-[60] hidden flex items-center justify-center bg-black/50 backdrop-blur-sm transition-opacity duration-300">
        <div class="bg-white rounded-lg shadow-2xl p-8 max-w-md w-full mx-4 transform transition-all scale-95 opacity-0 duration-300 relative border-t-4 border-trustori-blue" id="modal-content">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-trustori-dark transition-colors">
                <i class="fa-solid fa-xmark text-xl"></i>
            </button>
            <div class="flex items-start gap-4 mb-4">
                <div class="w-10 h-10 rounded-full bg-blue-50 flex items-center justify-center text-trustori-blue shrink-0">
                    <i class="fa-solid fa-lightbulb text-lg"></i>
                </div>
                <h3 class="text-xl font-bold text-trustori-dark mt-1" id="modal-title">Explanation Title</h3>
            </div>
            <p class="text-gray-600 text-sm leading-relaxed mb-6" id="modal-desc">
                Description goes here.
            </p>
            <div class="text-right">
                <button onclick="closeModal()" class="text-sm font-bold text-trustori-blue hover:text-blue-800 transition-colors">
                    Got it
                </button>
            </div>
        </div>
    </div>

    <!-- Logic Script -->
    <script>
        let radarChartInstance = null;
        let currentStep = 1;
        const totalSteps = 4;

        // Specific Labels for Each Option
        const optionLabels = {
            'a1': ["Low Priority", "Moderate", "Critical Focus"],
            'a2': ["Sunk Cost", "Informational", "Digital Asset"],
            'a3': ["Not Concerned", "Monitoring", "High Urgency"],
            'a4': ["Not Priority", "Exploring", "Top Priority"],
            'p1': ["Retailer Data", "Anonymous", "Direct 1st Party"],
            'p2': ["No Visibility", "Manual Check", "Real-Time Alerts"],
            'p3': ["Simple Print", "Hologram", "Digital Layer"],
            'p4': ["Full Batch", "Lot Level", "Unit Level"],
            'p5': ["Static Label", "Info Link", "Active Asset"],
            'p6': ["Manual", "Digital Docs", "Automated"],
            'p7': ["Unmeasured", "Estimates", "Unit Proven"],
            'p8': ["Frozen", "Delayed", "Agile"],
            's1': ["None", "Passive Web", "CRM Sync"],
            's2': ["Warehouse", "Milestone", "Real-Time Unit"],
            's3': ["Weak/None", "Basic QR", "Encrypted"],
            's4': ["Batch/SKU", "Case Level", "Unique Item ID"],
            's5': ["No Incentive", "Generic Info", "Rewards"],
            's6': ["Paper", "Digital PDF", "Smart Data"],
            's7': ["Estimates", "Batch Certs", "Circular Trace"],
            's8': ["Old Reports", "Dashboard", "Predictive AI"]
        };

        // Initialize on load
        window.addEventListener('load', () => {
           const allIds = ['a1','a2','a3','a4','p1','p2','p3','p4','p5','p6','p7','p8','s1','s2','s3','s4','s5','s6','s7','s8'];
           allIds.forEach(id => {
               renderLikert(id);
               updateLabels(id);
           });
        });

        // --- EXPLANATION DATA ---
        const explanations = {
            'a1': { title: "1st-Party Consumer Data", desc: "This evaluates if you rely entirely on retail/distribution partners for sales data, or if building direct relationships with end-users is a strategic priority for revenue growth." },
            'a2': { title: "Packaging as a Digital Asset", desc: "Is your packaging treated purely as a physical container and compliance requirement, or is it actively leveraged as a digital touchpoint for marketing, loyalty, and data collection?" },
            'a3': { title: "Grey Market & Counterfeit Urgency", desc: "Are issues like product diversion, counterfeiting, or unauthorized resellers actively harming your brand reputation and bottom line, requiring immediate intervention?" },
            'a4': { title: "Automated ESG & Compliance", desc: "Is tracking product origins, material lifecycle, and carbon footprint a regulatory necessity or a strategic priority for your brand's sustainability goals?" },
            'p1': { title: "Do you know who buys your product?", desc: "This metric evaluates whether you own direct 1st-party consumer data (name, email, preferences). Many brands rely on retailers and remain 'blind' to their actual end-users." },
            'p2': { title: "Can you instantly spot diverted stock?", desc: "Refers to Grey Market activities. If a product meant for Region A is sold in Region B, can your system detect it in real-time?" },
            'p3': { title: "Is your security easy to replicate?", desc: "Assess the barrier to entry for counterfeiters. Simple holograms or printed serial numbers are easily copied. Robust security requires a digital layer." },
            'p4': { title: "Can you recall specific bad units?", desc: "Precision of recall. If a defect is found, do you have to recall an entire batch (thousands of units) because you can't identify the specific few?" },
            'p5': { title: "Is your packaging a sunk cost?", desc: "Most packaging is trash after opening. Smart packaging turns that cost into an asset by acting as a digital portal for warranties, manuals, cross-selling, and loyalty." },
            'p6': { title: "Are audits manual and painful?", desc: "Compliance efficiency. Do you rely on paper trails, physical site visits, and spreadsheets? Digital infrastructure allows for instant 'chain of custody' reporting." },
            'p7': { title: "Is your green impact measurable?", desc: "Greenwashing vs. Proof. Can you trace the lifecycle of materials for every unit to prove sustainability claims?" },
            'p8': { title: "Can you reroute stock instantly?", desc: "Supply chain agility. If demand surges in one region, can you digitally identify and redirect transit inventory immediately without errors?" },
            's1': { title: "Do you capture direct consumer emails?", desc: "The capability to harvest contact info via packaging. Does scanning the QR code lead to a value-exchange that captures an email?" },
            's2': { title: "How granular is your location tracking?", desc: "Depth of visibility. Real-time GPS/Scan data at the unit level is the gold standard compared to Pallet or Case level." },
            's3': { title: "How strong is your authentication?", desc: "The technology verifying the product. 'Weak' is visual inspection. 'Strong' is cryptographic verification where the product digitally confirms its own authenticity." },
            's4': { title: "Is each unit uniquely identified?", desc: "Serialization maturity. Does every single item have a unique 'license plate' (UID), or do thousands of items share the same SKU/Batch code?" },
            's5': { title: "Does your engagement drive loyalty?", desc: "Conversion effectiveness. Are you offering points, rewards, and exclusive content that drives high user registration rates?" },
            's6': { title: "Is your compliance automated?", desc: "Digital Product Passports (DPP). Can your system automatically generate the required compliance data for any specific unit on demand?" },
            's7': { title: "Do you have material lifecycle data?", desc: "Circular economy readiness. Tracking raw material origins and recycling destinations for every unit to support advanced ESG reporting." },
            's8': { title: "Are you making real-time decisions?", desc: "Data latency. Are you making decisions based on live dashboards of scan activity, or relying on weeks-old sales reports from retailers?" }
        };

        // --- MODAL LOGIC ---
        function openModal(id) {
            const modal = document.getElementById('info-modal');
            const content = document.getElementById('modal-content');
            const title = document.getElementById('modal-title');
            const desc = document.getElementById('modal-desc');
            const data = explanations[id];

            if(data) {
                title.innerText = data.title;
                desc.innerText = data.desc;
                modal.classList.remove('hidden');
                requestAnimationFrame(() => {
                    content.classList.remove('scale-95', 'opacity-0');
                    content.classList.add('scale-100', 'opacity-100');
                });
            }
        }

        function closeModal() {
            const modal = document.getElementById('info-modal');
            const content = document.getElementById('modal-content');
            content.classList.remove('scale-100', 'opacity-100');
            content.classList.add('scale-95', 'opacity-0');
            setTimeout(() => { modal.classList.add('hidden'); }, 300);
        }

        // --- 3-OPTION BUTTON RENDERER ---
        function renderLikert(id) {
            const container = document.getElementById(`scale-${id}`);
            if (!container) return;
            container.innerHTML = ''; 
            const specificLabels = optionLabels[id] || ["Low", "Medium", "High"];

            for (let i = 1; i <= 3; i++) {
                const wrapper = document.createElement('div');
                wrapper.className = 'flex flex-col items-center gap-1 cursor-pointer group flex-1'; 
                
                let mappedValue = 2; 
                if (i === 2) mappedValue = 5; 
                if (i === 3) mappedValue = 9; 

                wrapper.onclick = () => selectRating(id, mappedValue, i);

                const btn = document.createElement('div');
                btn.className = 'w-10 h-10 rounded-full border-2 border-gray-300 bg-transparent likert-btn flex items-center justify-center group-hover:border-gray-400';
                
                const label = document.createElement('span');
                label.innerText = specificLabels[i-1];
                label.className = 'text-[9px] uppercase font-bold text-gray-400 tracking-wider text-center group-hover:text-gray-600 transition-colors likert-label mt-1 w-full';

                wrapper.appendChild(btn);
                wrapper.appendChild(label);
                container.appendChild(wrapper);
            }
        }

        function selectRating(id, mappedValue, optionIndex) {
            document.getElementById(`input-${id}`).value = mappedValue;
            updateLabels(id);
        }

        function updateLabels(id) {
            const val = parseInt(document.getElementById(`input-${id}`).value);
            let optIndex = 1;
            if (val === 5) optIndex = 2;
            if (val === 9) optIndex = 3;

            const container = document.getElementById(`scale-${id}`);
            const wrappers = container.children;
            
            let activeClass = 'bg-trustori-orange border-trustori-orange text-white';
            if (optIndex === 2) activeClass = 'bg-trustori-lightblue border-trustori-lightblue text-white';
            if (optIndex === 3) activeClass = 'bg-trustori-blue border-trustori-blue text-white';

            let activeTextClass = 'text-trustori-orange';
            if (optIndex === 2) activeTextClass = 'text-trustori-lightblue';
            if (optIndex === 3) activeTextClass = 'text-trustori-blue';

            for (let i = 0; i < wrappers.length; i++) {
                const btn = wrappers[i].querySelector('.likert-btn'); 
                const label = wrappers[i].querySelector('.likert-label'); 
                btn.className = 'w-10 h-10 rounded-full border-2 likert-btn flex items-center justify-center transition-all duration-200 border-gray-300 bg-transparent group-hover:border-gray-400';
                label.className = 'text-[9px] uppercase font-bold text-gray-400 tracking-wider text-center group-hover:text-gray-600 transition-colors likert-label mt-1 w-full';
                
                if ((i + 1) === optIndex) {
                    btn.className = `w-10 h-10 rounded-full border-2 likert-btn flex items-center justify-center transition-all duration-200 scale-110 shadow-md ${activeClass}`;
                    label.className = `text-[9px] uppercase font-bold tracking-wider text-center transition-colors likert-label mt-1 w-full ${activeTextClass}`;
                }
            }
            
            const descEl = document.getElementById(`desc-${id}`);
            if (descEl) {
                descEl.innerText = getFeedbackText(val, id);
                if (val <= 3) descEl.className = "text-xs font-semibold text-trustori-orange transition-all duration-300";
                else if (val <= 6) descEl.className = "text-xs font-semibold text-trustori-lightblue transition-all duration-300";
                else descEl.className = "text-xs font-semibold text-trustori-blue transition-all duration-300";
            }
        }

        function getFeedbackText(val, id) {
            val = parseInt(val);
            const guides = {
                'a1': { low: "Data isn't a core focus currently.", mid: "Important, but secondary to sales.", high: "Data drives our entire business strategy." },
                'a2': { low: "Packaging is just a protective shell.", mid: "We use it to show basic product info.", high: "Packaging is a critical digital touchpoint." },
                'a3': { low: "Not a major issue for us right now.", mid: "We are monitoring instances of it.", high: "It is directly impacting our revenue/brand." },
                'a4': { low: "We handle this manually or reactively.", mid: "Looking into digitization options.", high: "Automated compliance is a top priority." },
                'p1': { low: "Blind (Retailer owns all data)", mid: "Hazy (Anonymous website traffic only)", high: "Visible (Direct 1st-party consumer insights)" },
                'p2': { low: "Unknown (No visibility post-dock)", mid: "Reactive (Manual distributor checks)", high: "Controlled (Real-time diversion alerts)" },
                'p3': { low: "High Risk (Simple print/sticker)", mid: "Moderate (Holograms/Overt features)", high: "Secure (Bank-grade digital & physical layer)" },
                'p4': { low: "Wasteful (Full Batch Recall)", mid: "Segmented (Distributor/Lot level)", high: "Surgical (Single bad unit isolation)" },
                'p5': { low: "Sunk Cost (Static Label)", mid: "Informational (PDF/Landing Page)", high: "Asset (Loyalty & Data Generator)" },
                'p6': { low: "Manual (High Audit Risk)", mid: "Batch (Standard Reports)", high: "Automated (Instant Digital Passports)" },
                'p7': { low: "Unmeasured (Greenwashing Risk)", mid: "Estimated (Corporate Averages)", high: "Proven (Unit-Level Material Tracking)" },
                'p8': { low: "Slow (Frozen Supply Chain)", mid: "Delayed (Monthly/Weekly Reviews)", high: "Agile (Real-Time Rerouting)" },
                's1': { low: "None (No Data Flow)", mid: "Passive (Web Traffic)", high: "Active (Direct CRM Integration)" },
                's2': { low: "Warehouse Only", mid: "Milestone Scanning", high: "Real-Time Unit GPS" },
                's3': { low: "Weak (No Digital Layer)", mid: "Basic (Standard QR)", high: "Robust (Encrypted & Unique)" },
                's4': { low: "Batch/SKU Only", mid: "Case/Pallet ID", high: "Unique Digital ID per Unit" },
                's5': { low: "Low (No Incentives)", mid: "Standard (Generic Info)", high: "High (Personalized Rewards)" },
                's6': { low: "Paper-based", mid: "Digital (PDF Archives)", high: "Smart (Live Data Exchange)" },
                's7': { low: "None (Estimates only)", mid: "Batch (Supplier Certificates)", high: "Circular (End-to-End Trace)" },
                's8': { low: "Lagged (Reports are old)", mid: "Dashboard (Daily Updates)", high: "Predictive (AI-Driven Actions)" }
            };
            const g = guides[id];
            if (!g) return "";
            if (val <= 3) return g.low;
            if (val <= 6) return g.mid;
            return g.high;
        }

        // --- NAVIGATION LOGIC ---
        function navigateStep(direction) {
            // Validation for Step 1
            if (currentStep === 1 && direction === 1) {
                const company = document.getElementById('contact-company').value.trim();
                const name = document.getElementById('contact-name').value.trim();
                const email = document.getElementById('contact-email').value.trim();
                if (!company || !name || !email) {
                    document.getElementById('step-1-error').classList.remove('hidden');
                    return;
                }
                document.getElementById('step-1-error').classList.add('hidden');
            }

            const stepTitles = ["Company Profile", "Strategic Alignment", "Operational Gaps", "System Capabilities"];
            
            // Hide current step
            document.getElementById(`step-${currentStep}`).classList.add('hidden');
            
            currentStep += direction;

            // Show new step
            const newStepEl = document.getElementById(`step-${currentStep}`);
            newStepEl.classList.remove('hidden');
            newStepEl.classList.add(direction > 0 ? 'animate-slide-left' : 'animate-slide-right');

            // Update UI
            document.getElementById('progress-bar').style.width = `${(currentStep / totalSteps) * 100}%`;
            document.getElementById('step-counter').innerText = `Step ${currentStep} of ${totalSteps}`;
            document.getElementById('step-main-title').innerText = stepTitles[currentStep - 1];

            // Buttons
            document.getElementById('btn-back').classList.toggle('hidden', currentStep === 1);
            
            if (currentStep === totalSteps) {
                document.getElementById('btn-next').classList.add('hidden');
                document.getElementById('btn-submit').classList.remove('hidden');
            } else {
                document.getElementById('btn-next').classList.remove('hidden');
                document.getElementById('btn-submit').classList.add('hidden');
                document.getElementById('btn-next').innerHTML = `Next: ${stepTitles[currentStep]} <i class="fa-solid fa-arrow-right text-trustori-orange group-hover:translate-x-1 transition-transform ml-2"></i>`;
            }

            document.getElementById('survey-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // --- GOOGLE SHEETS INTEGRATION (SIMULATED) ---
        async function submitToGoogleSheet(auditData) {
            // NOTE: Replace this URL with your deployed Google Apps Script Web App URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycb.../exec'; 
            
            console.log("Submitting data to Google Sheets:", auditData);
            
            /* Uncomment when you have the real URL
            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // standard for GAS web apps to avoid CORS issues on basic POSTs
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(auditData)
                });
                console.log('Submission successfully sent.');
            } catch (error) {
                console.error('Error submitting to Google Sheets:', error);
            }
            */
            
            // Simulating network delay
            return new Promise(resolve => setTimeout(resolve, 800));
        }

        async function calculateAndShowResults() {
            // UI Loading State
            document.getElementById('submit-text').innerText = "Analyzing...";
            document.getElementById('submit-icon').classList.add('hidden');
            document.getElementById('submit-spinner').classList.remove('hidden');

            const getVal = (id) => parseInt(document.getElementById(`input-${id}`).value);
            
            // Collect Data
            const auditData = {
                company: document.getElementById('contact-company').value,
                name: document.getElementById('contact-name').value,
                title: document.getElementById('contact-title').value,
                email: document.getElementById('contact-email').value,
                phone: document.getElementById('contact-phone').value,
                date: new Date().toISOString(),
                attitude: [1,2,3,4].map(i => getVal(`a${i}`)),
                pain: [1,2,3,4,5,6,7,8].map(i => getVal(`p${i}`)),
                solution: [1,2,3,4,5,6,7,8].map(i => getVal(`s${i}`))
            };

            // Send to Google Sheets
            await submitToGoogleSheet(auditData);

            // Calculations for Radar Chart
            const a = auditData.attitude;
            const p = auditData.pain;
            const s = auditData.solution;

            // Average Attitude for "Data Strategy" axis
            const avgAttitude = a.reduce((sum, val) => sum + val, 0) / 4;

            const cats = [
                avgAttitude, // Axis 1: Data Strategy Alignment
                (p[0] + s[0]) / 2, // Data Capture
                (p[1] + s[1]) / 2, // Visibility
                (p[2] + s[2]) / 2, // Security
                (p[3] + s[3]) / 2, // Serialization
                (p[4] + s[4]) / 2, // Engagement
                (p[5] + s[5]) / 2, // Compliance
                (p[6] + s[6]) / 2, // Sustainability
                (p[7] + s[7]) / 2  // Agility
            ];

            // Reset Button State
            document.getElementById('submit-text').innerText = "Generate Analysis";
            document.getElementById('submit-icon').classList.remove('hidden');
            document.getElementById('submit-spinner').classList.add('hidden');

            // Switch to Results View
            document.getElementById('survey-container').classList.add('hidden');
            document.getElementById('results-section').classList.remove('hidden');
            document.getElementById('page-subtitle').innerHTML = "Audit complete. Review your performance matrix below.";

            renderRadarChart(cats);

            const totalAvg = cats.reduce((sum, val) => sum + val, 0) / cats.length;
            const totalLabel = document.getElementById('score-total');
            const totalDesc = document.getElementById('score-description');
            
            if (totalAvg < 4) {
                totalLabel.innerText = "Low";
                totalLabel.className = "text-5xl md:text-6xl font-bold text-white mb-2"; 
                totalDesc.innerText = "Defensive Posture. High operational risk detected.";
            } else if (totalAvg < 7.5) {
                totalLabel.innerText = "Medium";
                totalLabel.className = "text-5xl md:text-6xl font-bold text-trustori-orange mb-2";
                totalDesc.innerText = "Transitioning. Partial visibility, but gaps remain in data loop.";
            } else {
                totalLabel.innerText = "High";
                totalLabel.className = "text-5xl md:text-6xl font-bold text-trustori-lightblue mb-2";
                totalDesc.innerText = "Strategic Asset. Your infrastructure is driving secure growth.";
            }

            // Generate recommendations based on core system gaps (ignoring attitude for specific tips)
            generateRecommendations(cats[1], cats[2], cats[3], cats[4], cats[5]);
            
            setTimeout(() => {
                const navHeight = 100;
                const targetPosition = document.getElementById('results-section').getBoundingClientRect().top + window.scrollY - navHeight;
                window.scrollTo({ top: targetPosition, behavior: 'smooth' });
            }, 100);
        }

        function renderRadarChart(dataValues) {
            const ctx = document.getElementById('auditRadarChart').getContext('2d');
            if (radarChartInstance) radarChartInstance.destroy();

            const blue = '#0047BA';
            const orange = '#FF671D';
            const grey = '#E2E8F0';
            const isMobile = window.innerWidth < 768;
            const labelSize = isMobile ? 8 : 11;

            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Data Strategy', 'Data Capture', 'Visibility', 'Security', 'Serialization', 'Engagement', 'Compliance', 'Sustainability', 'Agility'],
                    datasets: [
                        {
                            label: 'You',
                            data: dataValues,
                            fill: false,
                            backgroundColor: 'transparent',
                            borderColor: orange,
                            pointBackgroundColor: orange, 
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: isMobile ? 3 : 5,
                            borderWidth: 3,
                            tension: 0
                        },
                        {
                            label: 'Goal',
                            data: [10, 9, 9, 10, 10, 9, 9, 9, 9], // 9 items
                            fill: false,
                            backgroundColor: 'transparent',
                            borderColor: blue,
                            pointBackgroundColor: blue, 
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: isMobile ? 3 : 5,
                            borderWidth: 3,
                            tension: 0
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: grey },
                            grid: { color: grey },
                            pointLabels: {
                                font: { family: "'Hanken Grotesk', sans-serif", size: labelSize, weight: '600' },
                                color: '#64748b'
                            },
                            suggestedMin: 0,
                            suggestedMax: 10,
                            ticks: { display: false, stepSize: 2 }
                        }
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function generateRecommendations(c1, c2, c3, c4, c5) {
            const container = document.getElementById('recommendations-container');
            container.innerHTML = ''; 
            const addCard = (title, text, tag) => {
                const html = `
                    <div class="bg-white p-6 md:p-8 rounded-lg shadow-md hover:shadow-xl transition-shadow flex flex-col h-full border-l-4 border-l-trustori-orange group">
                        <div class="mb-4">
                            <span class="text-[9px] md:text-[10px] font-bold uppercase tracking-widest text-trustori-blue bg-blue-50 px-3 py-1 inline-block rounded-sm">${tag}</span>
                        </div>
                        <h4 class="font-bold text-lg md:text-xl text-trustori-dark mb-3 group-hover:text-trustori-blue transition-colors">${title}</h4>
                        <p class="text-gray-500 leading-relaxed flex-grow text-xs md:text-sm">${text}</p>
                    </div>`;
                container.innerHTML += html;
            };

            let count = 0;
            if (c4 < 5) { addCard("Implement Digital Twin (Serialization)", "Migrate from batch codes to unique digital IDs per unit. This is the absolute foundation for tracking and engagement.", "Critical Infrastructure"); count++; }
            if (c1 < 4 || c5 < 4) { addCard("Deploy Direct-to-Consumer Loop", "Your current QR strategy is passive. Implement value-exchange triggers (Warranty, Authenticity Check) to capture user emails.", "Growth Asset"); count++; }
            if (c2 < 5) { addCard("Geo-Fencing & Grey Market Detection", "Integrate scan data with your ERP. Flag scans that appear in unauthorized regions automatically.", "Loss Prevention"); count++; }
            if (c3 < 5) { addCard("Layered Authentication", "Add a digital verification layer (like a dynamic landing page) to your physical security features to prevent easy copying.", "Brand Protection"); count++; }
            if (count === 0) {
                 addCard("Optimization Phase", "Your infrastructure is robust. Focus on analyzing the data you are collecting to optimize supply chain efficiency.", "Advanced Optimization");
                 addCard("Loyalty Integration", "Deepen the connection by integrating scan data directly into your loyalty rewards program.", "Retention");
            }
        }

        function resetAnalysis() {
            currentStep = 1;
            document.getElementById('results-section').classList.add('hidden');
            document.getElementById('survey-container').classList.remove('hidden');
            
            // Reset to Step 1 UI
            document.querySelectorAll('.step-content').forEach(el => el.classList.add('hidden'));
            document.getElementById('step-1').classList.remove('hidden');
            document.getElementById('progress-bar').style.width = '25%';
            document.getElementById('step-counter').innerText = 'Step 1 of 4';
            document.getElementById('step-main-title').innerText = 'Company Profile';
            
            document.getElementById('btn-back').classList.add('hidden');
            document.getElementById('btn-next').classList.remove('hidden');
            document.getElementById('btn-next').innerHTML = `Next: Strategic Alignment <i class="fa-solid fa-arrow-right text-trustori-orange group-hover:translate-x-1 transition-transform ml-2"></i>`;
            document.getElementById('btn-submit').classList.add('hidden');

            window.scrollTo({ top: 0, behavior: 'smooth' });
            document.getElementById('page-subtitle').innerText = "Evaluate your brand's data maturity. Identify operational blind spots and map them to strategic capabilities.";
        }
    </script>
</body>
</html>
